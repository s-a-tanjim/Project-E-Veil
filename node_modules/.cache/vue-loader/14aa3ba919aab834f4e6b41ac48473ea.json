{"remainingRequest":"D:\\Programs\\Project\\Project-E-Veil\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Programs\\Project\\Project-E-Veil\\src\\components\\outbox\\outbox_main.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Programs\\Project\\Project-E-Veil\\src\\components\\outbox\\outbox_main.vue","mtime":1587569253242},{"path":"D:\\Programs\\Project\\Project-E-Veil\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Programs\\Project\\Project-E-Veil\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\Programs\\Project\\Project-E-Veil\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Programs\\Project\\Project-E-Veil\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgZmlyZWJhc2UgZnJvbSAiZmlyZWJhc2UiOw0KaW1wb3J0IFZ1ZVRhYmxlRHluYW1pYyBmcm9tICJ2dWUtdGFibGUtZHluYW1pYyI7DQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGE6IGZ1bmN0aW9uKCkgew0KICAgIHJldHVybiB7DQogICAgICB1c2VybmFtZTogIiIsDQogICAgICBlbWFpbDogIiIsDQogICAgICBzZWxlY3RNc2dGbGFnOiBmYWxzZSwNCiAgICAgIHVwZGF0ZVRpbWU6ICIgIiwNCiAgICAgIHBhcmFtczogew0KICAgICAgICBkYXRhOiBbWyJUbyIsICJUaXRsZSIsICJEZXNjcmlwdGlvbiIsICJpZCJdXSwNCiAgICAgICAgaGVhZGVyOiAicm93IiwNCiAgICAgICAgc3RyaXBlOiB0cnVlLA0KICAgICAgICBzaG93Q2hlY2s6IHRydWUsDQogICAgICAgIGVuYWJsZVNlYXJjaDogdHJ1ZSwNCiAgICAgICAgc29ydDogWzAsIDFdLA0KICAgICAgICBwYWdpbmF0aW9uOiB0cnVlLA0KICAgICAgICBwYWdlU2l6ZTogMTAsDQogICAgICAgIHBhZ2VTaXplczogWzEwLCAyMCwgNTBdLA0KICAgICAgICBjb2x1bW5XaWR0aDogWw0KICAgICAgICAgIHsgY29sdW1uOiAwLCB3aWR0aDogIjIwJSIgfSwNCiAgICAgICAgICB7IGNvbHVtbjogMSwgd2lkdGg6ICIzMCUiIH0sDQogICAgICAgICAgeyBjb2x1bW46IDIsIHdpZHRoOiAiNTAlIiB9LA0KICAgICAgICAgIHsgY29sdW1uOiAzLCB3aWR0aDogIjAlIiB9DQogICAgICAgIF0NCiAgICAgIH0NCiAgICB9Ow0KICB9LA0KICBjb21wb25lbnRzOiB7IFZ1ZVRhYmxlRHluYW1pYyB9LA0KICBtZXRob2RzOiB7DQogICAgZ2V0Q2xpY2tlZFJvdyhpbmRleCwgZGF0YSkgew0KICAgICAgLy9jb25zb2xlLmxvZygiZ2V0Q2xpY2tlZFJvdyAgOiIsIGluZGV4LCBkYXRhKTsNCiAgICAgIGlmIChpbmRleCA9PSAwKSByZXR1cm47DQogICAgICB2YXIgdXJsID0gIi9tZXNzYWdlLyIgKyBkYXRhWzNdICsgIi9vdXRib3giOw0KICAgICAgdGhpcy4kcm91dGVyLnB1c2godXJsKTsNCiAgICB9LA0KICAgIGdldERhdGFGcm9tRmlyZWJhc2UoKSB7DQogICAgICB2YXIgcmVmVXNlciA9ICJlbWFpbHMvIiArIHRoaXMudXNlcm5hbWUgKyAiL3NlbnQiOw0KICAgICAgdmFyIGVtYWlsc1JlZiA9IGZpcmViYXNlLmRhdGFiYXNlKCkucmVmKHJlZlVzZXIpOw0KICAgICAgZW1haWxzUmVmLm9uKA0KICAgICAgICAidmFsdWUiLA0KICAgICAgICBkYXRhID0+IHsNCiAgICAgICAgICB2YXIgYWxsZGF0YSA9IGRhdGEudmFsKCk7DQogICAgICAgICAgaWYgKGFsbGRhdGEgPT09IG51bGwgfHwgYWxsZGF0YSA9PT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibm8tZGF0YS1lcnJvciIpLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibm8tZGF0YS1lcnJvciIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQogICAgICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGFsbGRhdGEpOw0KICAgICAgICAgICAga2V5cy5yZXZlcnNlKCk7DQogICAgICAgICAgICBrZXlzLmZvckVhY2goaW5kZXggPT4gew0KICAgICAgICAgICAgICBpZiAoYWxsZGF0YVtpbmRleF0uYmluID09ICIwIikgew0KICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gbmV3IEFycmF5KDQpOw0KICAgICAgICAgICAgICAgIHRlbXBbMF0gPSBhbGxkYXRhW2luZGV4XS50bzsNCiAgICAgICAgICAgICAgICB0ZW1wWzFdID0gYWxsZGF0YVtpbmRleF0uc3ViamVjdDsNCiAgICAgICAgICAgICAgICB0ZW1wWzJdID0gYWxsZGF0YVtpbmRleF0ubWVzc2FnZTsNCiAgICAgICAgICAgICAgICB0ZW1wWzNdID0gaW5kZXg7DQogICAgICAgICAgICAgICAgdGhpcy5wYXJhbXMuZGF0YS5wdXNoKHRlbXApOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICB9DQogICAgICAgICAgdGhpcy5wcmludFByZXNlbnRUaW1lKCk7DQogICAgICAgIH0sDQogICAgICAgIGVyckVtYWlsc0RhdGEgPT4gew0KICAgICAgICAgIGNvbnNvbGUubG9nKGVyckVtYWlsc0RhdGEpOw0KICAgICAgICB9DQogICAgICApOw0KICAgIH0sDQogICAgcHJpbnRQcmVzZW50VGltZSgpIHsNCiAgICAgIHZhciB0b2RheSA9IG5ldyBEYXRlKCk7DQogICAgICB0aGlzLnVwZGF0ZVRpbWUgPQ0KICAgICAgICB0b2RheS5nZXRIb3VycygpICsgIjoiICsgdG9kYXkuZ2V0TWludXRlcygpICsgIjoiICsgdG9kYXkuZ2V0U2Vjb25kcygpOw0KICAgIH0sDQogICAgb25TZWxlY3Rpb25DaGFuZ2UoKSB7DQogICAgICBpZiAodGhpcy4kcmVmcy50YWJsZS5nZXRDaGVja2VkUm93RGF0YXModHJ1ZSkubGVuZ3RoID4gMSkgew0KICAgICAgICB0aGlzLnNlbGVjdE1zZ0ZsYWcgPSB0cnVlOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy5zZWxlY3RNc2dGbGFnID0gZmFsc2U7DQogICAgICB9DQogICAgfSwNCiAgICBkZWxldGVNc2coKSB7DQogICAgICB2YXIgZW1haWxPYmogPSBuZXcgT2JqZWN0KCk7DQogICAgICBmb3IgKA0KICAgICAgICB2YXIgaSA9IDE7DQogICAgICAgIGkgPCB0aGlzLiRyZWZzLnRhYmxlLmdldENoZWNrZWRSb3dEYXRhcyh0cnVlKS5sZW5ndGg7DQogICAgICAgIGkrKw0KICAgICAgKSB7DQogICAgICAgIHZhciB4ID0gdGhpcy4kcmVmcy50YWJsZS5nZXRDaGVja2VkUm93RGF0YXModHJ1ZSlbaV1bM10gKyAiL2JpbiI7DQogICAgICAgIGVtYWlsT2JqW3hdID0gIjEiOw0KICAgICAgfQ0KICAgICAgd2hpbGUgKHRoaXMucGFyYW1zLmRhdGEubGVuZ3RoID4gMSkgew0KICAgICAgICB0aGlzLnBhcmFtcy5kYXRhLnBvcCgpOw0KICAgICAgfQ0KICAgICAgdmFyIHJlZiA9ICJlbWFpbHMvIiArIHRoaXMudXNlcm5hbWUgKyAiL3NlbnQvIjsNCiAgICAgIHZhciB1c2VyUmVmID0gZmlyZWJhc2UuZGF0YWJhc2UoKS5yZWYocmVmKTsNCiAgICAgIHVzZXJSZWYudXBkYXRlKGVtYWlsT2JqKS50aGVuKCgpID0+IHsNCiAgICAgICAgdGhpcy5wcmludFByZXNlbnRUaW1lKCk7DQogICAgICAgIHRoaXMuc2VsZWN0TXNnRmxhZyA9IGZhbHNlOw0KICAgICAgfSk7DQogICAgfQ0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIHRoaXMuZW1haWwgPSBmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXIuZW1haWw7DQogICAgdGhpcy51c2VybmFtZSA9IHRoaXMuZW1haWwuc3Vic3RyaW5nKDAsIHRoaXMuZW1haWwubGVuZ3RoIC0gMTApOw0KICAgIHRoaXMuZ2V0RGF0YUZyb21GaXJlYmFzZSgpOw0KICB9DQp9Ow0K"},{"version":3,"sources":["outbox_main.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"outbox_main.vue","sourceRoot":"src/components/outbox","sourcesContent":["<template>\r\n  <div>\r\n    <!-- Topbar will be here -->\r\n    <component v-bind:is=\"'Navbar'\"></component>\r\n    <div class=\"wrapper-body\">\r\n      <!-- Sidebar -->\r\n      <component v-bind:is=\"'Sidebar'\"></component>\r\n      <div class=\"body-container\">\r\n        <div class=\"base-demo\">\r\n          <vue-table-dynamic\r\n            :params=\"params\"\r\n            @selection-change=\"onSelectionChange\"\r\n            v-on:row-click=\"getClickedRow\"\r\n            ref=\"table\"\r\n          ></vue-table-dynamic>\r\n          <div style=\"text-align:center;display:none;\" id=\"no-data-error\">No data found</div>\r\n        </div>\r\n        <div style=\"text-align:right;color:gray;margin-top:30px;\">\r\n          <p>Last updated at {{ updateTime }}</p>\r\n        </div>\r\n        <button v-if=\"selectMsgFlag\" class=\"msg-delete-btn\" @click=\"deleteMsg\">\r\n          <i class=\"fas fa-trash-alt\"></i>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport firebase from \"firebase\";\r\nimport VueTableDynamic from \"vue-table-dynamic\";\r\nexport default {\r\n  data: function() {\r\n    return {\r\n      username: \"\",\r\n      email: \"\",\r\n      selectMsgFlag: false,\r\n      updateTime: \" \",\r\n      params: {\r\n        data: [[\"To\", \"Title\", \"Description\", \"id\"]],\r\n        header: \"row\",\r\n        stripe: true,\r\n        showCheck: true,\r\n        enableSearch: true,\r\n        sort: [0, 1],\r\n        pagination: true,\r\n        pageSize: 10,\r\n        pageSizes: [10, 20, 50],\r\n        columnWidth: [\r\n          { column: 0, width: \"20%\" },\r\n          { column: 1, width: \"30%\" },\r\n          { column: 2, width: \"50%\" },\r\n          { column: 3, width: \"0%\" }\r\n        ]\r\n      }\r\n    };\r\n  },\r\n  components: { VueTableDynamic },\r\n  methods: {\r\n    getClickedRow(index, data) {\r\n      //console.log(\"getClickedRow  :\", index, data);\r\n      if (index == 0) return;\r\n      var url = \"/message/\" + data[3] + \"/outbox\";\r\n      this.$router.push(url);\r\n    },\r\n    getDataFromFirebase() {\r\n      var refUser = \"emails/\" + this.username + \"/sent\";\r\n      var emailsRef = firebase.database().ref(refUser);\r\n      emailsRef.on(\r\n        \"value\",\r\n        data => {\r\n          var alldata = data.val();\r\n          if (alldata === null || alldata === undefined) {\r\n            document.getElementById(\"no-data-error\").style.display = \"block\";\r\n          } else {\r\n            document.getElementById(\"no-data-error\").style.display = \"none\";\r\n            var keys = Object.keys(alldata);\r\n            keys.reverse();\r\n            keys.forEach(index => {\r\n              if (alldata[index].bin == \"0\") {\r\n                var temp = new Array(4);\r\n                temp[0] = alldata[index].to;\r\n                temp[1] = alldata[index].subject;\r\n                temp[2] = alldata[index].message;\r\n                temp[3] = index;\r\n                this.params.data.push(temp);\r\n              }\r\n            });\r\n          }\r\n          this.printPresentTime();\r\n        },\r\n        errEmailsData => {\r\n          console.log(errEmailsData);\r\n        }\r\n      );\r\n    },\r\n    printPresentTime() {\r\n      var today = new Date();\r\n      this.updateTime =\r\n        today.getHours() + \":\" + today.getMinutes() + \":\" + today.getSeconds();\r\n    },\r\n    onSelectionChange() {\r\n      if (this.$refs.table.getCheckedRowDatas(true).length > 1) {\r\n        this.selectMsgFlag = true;\r\n      } else {\r\n        this.selectMsgFlag = false;\r\n      }\r\n    },\r\n    deleteMsg() {\r\n      var emailObj = new Object();\r\n      for (\r\n        var i = 1;\r\n        i < this.$refs.table.getCheckedRowDatas(true).length;\r\n        i++\r\n      ) {\r\n        var x = this.$refs.table.getCheckedRowDatas(true)[i][3] + \"/bin\";\r\n        emailObj[x] = \"1\";\r\n      }\r\n      while (this.params.data.length > 1) {\r\n        this.params.data.pop();\r\n      }\r\n      var ref = \"emails/\" + this.username + \"/sent/\";\r\n      var userRef = firebase.database().ref(ref);\r\n      userRef.update(emailObj).then(() => {\r\n        this.printPresentTime();\r\n        this.selectMsgFlag = false;\r\n      });\r\n    }\r\n  },\r\n  created() {\r\n    this.email = firebase.auth().currentUser.email;\r\n    this.username = this.email.substring(0, this.email.length - 10);\r\n    this.getDataFromFirebase();\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n</style>"]}]}