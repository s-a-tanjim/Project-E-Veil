{"remainingRequest":"D:\\Programs\\Project\\project-eveil\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Programs\\Project\\project-eveil\\src\\components\\inbox\\inbox_main.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Programs\\Project\\project-eveil\\src\\components\\inbox\\inbox_main.vue","mtime":1587569152423},{"path":"D:\\Programs\\Project\\project-eveil\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Programs\\Project\\project-eveil\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Programs\\Project\\project-eveil\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\Programs\\Project\\project-eveil\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Programs\\Project\\project-eveil\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgZmlyZWJhc2UgZnJvbSAiZmlyZWJhc2UiOw0KaW1wb3J0IFZ1ZVRhYmxlRHluYW1pYyBmcm9tICJ2dWUtdGFibGUtZHluYW1pYyI7DQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGE6IGZ1bmN0aW9uKCkgew0KICAgIHJldHVybiB7DQogICAgICB1c2VybmFtZTogIiIsDQogICAgICBlbWFpbDogIiIsDQogICAgICBzZWxlY3RNc2dGbGFnOiBmYWxzZSwNCiAgICAgIHVwZGF0ZVRpbWU6ICIgIiwNCiAgICAgIHBhcmFtczogew0KICAgICAgICBkYXRhOiBbWyJGcm9tIiwgIlRpdGxlIiwgIkRlc2NyaXB0aW9uIiwgImlkIl1dLA0KICAgICAgICBoZWFkZXI6ICJyb3ciLA0KICAgICAgICBzdHJpcGU6IHRydWUsDQogICAgICAgIHNob3dDaGVjazogdHJ1ZSwNCiAgICAgICAgZW5hYmxlU2VhcmNoOiB0cnVlLA0KICAgICAgICBzb3J0OiBbMCwgMV0sDQogICAgICAgIHBhZ2luYXRpb246IHRydWUsDQogICAgICAgIHBhZ2VTaXplOiAxMCwNCiAgICAgICAgcGFnZVNpemVzOiBbMTAsIDIwLCA1MF0sDQogICAgICAgIGNvbHVtbldpZHRoOiBbDQogICAgICAgICAgeyBjb2x1bW46IDAsIHdpZHRoOiAiMjAlIiB9LA0KICAgICAgICAgIHsgY29sdW1uOiAxLCB3aWR0aDogIjMwJSIgfSwNCiAgICAgICAgICB7IGNvbHVtbjogMiwgd2lkdGg6ICI1MCUiIH0sDQogICAgICAgICAgeyBjb2x1bW46IDMsIHdpZHRoOiAiMCUiIH0NCiAgICAgICAgXQ0KICAgICAgfQ0KICAgIH07DQogIH0sDQogIGNvbXBvbmVudHM6IHsgVnVlVGFibGVEeW5hbWljIH0sDQogIG1ldGhvZHM6IHsNCiAgICBnZXRDbGlja2VkUm93KGluZGV4LCBkYXRhKSB7DQogICAgICAvL2NvbnNvbGUubG9nKCJnZXRDbGlja2VkUm93ICA6IiwgaW5kZXgsIGRhdGEpOw0KICAgICAgaWYgKGluZGV4ID09IDApIHJldHVybjsNCiAgICAgIHZhciB1cmwgPSAiL21lc3NhZ2UvIiArIGRhdGFbM10gKyAiL2luYm94IjsNCiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHVybCk7DQogICAgfSwNCiAgICBnZXREYXRhRnJvbUZpcmViYXNlKCkgew0KICAgICAgdmFyIHJlZlVzZXIgPSAiZW1haWxzLyIgKyB0aGlzLnVzZXJuYW1lICsgIi9yZWNlaXZlZCI7DQogICAgICB2YXIgZW1haWxzUmVmID0gZmlyZWJhc2UuZGF0YWJhc2UoKS5yZWYocmVmVXNlcik7DQogICAgICBlbWFpbHNSZWYub24oDQogICAgICAgICJ2YWx1ZSIsDQogICAgICAgIGRhdGEgPT4gew0KICAgICAgICAgIHZhciBhbGxkYXRhID0gZGF0YS52YWwoKTsNCiAgICAgICAgICBpZiAoYWxsZGF0YSA9PT0gbnVsbCB8fCBhbGxkYXRhID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJuby1kYXRhLWVycm9yIikuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7DQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJuby1kYXRhLWVycm9yIikuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgICAgICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoYWxsZGF0YSk7DQogICAgICAgICAgICBrZXlzLnJldmVyc2UoKTsNCiAgICAgICAgICAgIGtleXMuZm9yRWFjaChpbmRleCA9PiB7DQogICAgICAgICAgICAgIGlmIChhbGxkYXRhW2luZGV4XS5iaW4gPT0gIjAiKSB7DQogICAgICAgICAgICAgICAgdmFyIHRlbXAgPSBuZXcgQXJyYXkoNCk7DQogICAgICAgICAgICAgICAgdGVtcFswXSA9IGFsbGRhdGFbaW5kZXhdLmZyb207DQogICAgICAgICAgICAgICAgdGVtcFsxXSA9IGFsbGRhdGFbaW5kZXhdLnN1YmplY3Q7DQogICAgICAgICAgICAgICAgdGVtcFsyXSA9IGFsbGRhdGFbaW5kZXhdLm1lc3NhZ2U7DQogICAgICAgICAgICAgICAgdGVtcFszXSA9IGluZGV4Ow0KICAgICAgICAgICAgICAgIHRoaXMucGFyYW1zLmRhdGEucHVzaCh0ZW1wKTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgfQ0KICAgICAgICAgIHRoaXMucHJpbnRQcmVzZW50VGltZSgpOw0KICAgICAgICB9LA0KICAgICAgICBlcnJFbWFpbHNEYXRhID0+IHsNCiAgICAgICAgICBjb25zb2xlLmxvZyhlcnJFbWFpbHNEYXRhKTsNCiAgICAgICAgfQ0KICAgICAgKTsNCiAgICB9LA0KICAgIHByaW50UHJlc2VudFRpbWUoKSB7DQogICAgICB2YXIgdG9kYXkgPSBuZXcgRGF0ZSgpOw0KICAgICAgdGhpcy51cGRhdGVUaW1lID0NCiAgICAgICAgdG9kYXkuZ2V0SG91cnMoKSArICI6IiArIHRvZGF5LmdldE1pbnV0ZXMoKSArICI6IiArIHRvZGF5LmdldFNlY29uZHMoKTsNCiAgICB9LA0KICAgIG9uU2VsZWN0aW9uQ2hhbmdlKCkgew0KICAgICAgaWYgKHRoaXMuJHJlZnMudGFibGUuZ2V0Q2hlY2tlZFJvd0RhdGFzKHRydWUpLmxlbmd0aCA+IDEpIHsNCiAgICAgICAgdGhpcy5zZWxlY3RNc2dGbGFnID0gdHJ1ZTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuc2VsZWN0TXNnRmxhZyA9IGZhbHNlOw0KICAgICAgfQ0KICAgIH0sDQogICAgZGVsZXRlTXNnKCkgew0KICAgICAgdmFyIGVtYWlsT2JqID0gbmV3IE9iamVjdCgpOw0KICAgICAgZm9yICgNCiAgICAgICAgdmFyIGkgPSAxOw0KICAgICAgICBpIDwgdGhpcy4kcmVmcy50YWJsZS5nZXRDaGVja2VkUm93RGF0YXModHJ1ZSkubGVuZ3RoOw0KICAgICAgICBpKysNCiAgICAgICkgew0KICAgICAgICB2YXIgeCA9IHRoaXMuJHJlZnMudGFibGUuZ2V0Q2hlY2tlZFJvd0RhdGFzKHRydWUpW2ldWzNdICsgIi9iaW4iOw0KICAgICAgICBlbWFpbE9ialt4XSA9ICIxIjsNCiAgICAgIH0NCiAgICAgIHdoaWxlICh0aGlzLnBhcmFtcy5kYXRhLmxlbmd0aCA+IDEpIHsNCiAgICAgICAgdGhpcy5wYXJhbXMuZGF0YS5wb3AoKTsNCiAgICAgIH0NCiAgICAgIHZhciByZWYgPSAiZW1haWxzLyIgKyB0aGlzLnVzZXJuYW1lICsgIi9yZWNlaXZlZC8iOw0KICAgICAgdmFyIHVzZXJSZWYgPSBmaXJlYmFzZS5kYXRhYmFzZSgpLnJlZihyZWYpOw0KICAgICAgdXNlclJlZi51cGRhdGUoZW1haWxPYmopLnRoZW4oKCkgPT4gew0KICAgICAgICB0aGlzLnByaW50UHJlc2VudFRpbWUoKTsNCiAgICAgICAgdGhpcy5zZWxlY3RNc2dGbGFnID0gZmFsc2U7DQogICAgICB9KTsNCiAgICB9DQogIH0sDQogIGNyZWF0ZWQoKSB7DQogICAgdGhpcy5lbWFpbCA9IGZpcmViYXNlLmF1dGgoKS5jdXJyZW50VXNlci5lbWFpbDsNCiAgICB0aGlzLnVzZXJuYW1lID0gdGhpcy5lbWFpbC5zdWJzdHJpbmcoMCwgdGhpcy5lbWFpbC5sZW5ndGggLSAxMCk7DQogICAgdGhpcy5nZXREYXRhRnJvbUZpcmViYXNlKCk7DQogIH0NCn07DQo="},{"version":3,"sources":["inbox_main.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"inbox_main.vue","sourceRoot":"src/components/inbox","sourcesContent":["<template>\r\n  <div>\r\n    <!-- Topbar will be here -->\r\n    <component v-bind:is=\"'Navbar'\"></component>\r\n    <div class=\"wrapper-body\">\r\n      <!-- Sidebar -->\r\n      <component v-bind:is=\"'Sidebar'\"></component>\r\n      <div class=\"body-container\">\r\n        <div class=\"base-demo\">\r\n          <vue-table-dynamic\r\n            :params=\"params\"\r\n            v-on:row-click=\"getClickedRow\"\r\n            @selection-change=\"onSelectionChange\"\r\n            ref=\"table\"\r\n          ></vue-table-dynamic>\r\n          <div style=\"text-align:center;display:none;\" id=\"no-data-error\">No data found</div>\r\n        </div>\r\n        <div style=\"text-align:right;color:gray;margin-top:30px;\">\r\n          <p>Last updated at {{ updateTime }}</p>\r\n        </div>\r\n        <button v-if=\"selectMsgFlag\" class=\"msg-delete-btn\" @click=\"deleteMsg\">\r\n          <i class=\"fas fa-trash-alt\"></i>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport firebase from \"firebase\";\r\nimport VueTableDynamic from \"vue-table-dynamic\";\r\nexport default {\r\n  data: function() {\r\n    return {\r\n      username: \"\",\r\n      email: \"\",\r\n      selectMsgFlag: false,\r\n      updateTime: \" \",\r\n      params: {\r\n        data: [[\"From\", \"Title\", \"Description\", \"id\"]],\r\n        header: \"row\",\r\n        stripe: true,\r\n        showCheck: true,\r\n        enableSearch: true,\r\n        sort: [0, 1],\r\n        pagination: true,\r\n        pageSize: 10,\r\n        pageSizes: [10, 20, 50],\r\n        columnWidth: [\r\n          { column: 0, width: \"20%\" },\r\n          { column: 1, width: \"30%\" },\r\n          { column: 2, width: \"50%\" },\r\n          { column: 3, width: \"0%\" }\r\n        ]\r\n      }\r\n    };\r\n  },\r\n  components: { VueTableDynamic },\r\n  methods: {\r\n    getClickedRow(index, data) {\r\n      //console.log(\"getClickedRow  :\", index, data);\r\n      if (index == 0) return;\r\n      var url = \"/message/\" + data[3] + \"/inbox\";\r\n      this.$router.push(url);\r\n    },\r\n    getDataFromFirebase() {\r\n      var refUser = \"emails/\" + this.username + \"/received\";\r\n      var emailsRef = firebase.database().ref(refUser);\r\n      emailsRef.on(\r\n        \"value\",\r\n        data => {\r\n          var alldata = data.val();\r\n          if (alldata === null || alldata === undefined) {\r\n            document.getElementById(\"no-data-error\").style.display = \"block\";\r\n          } else {\r\n            document.getElementById(\"no-data-error\").style.display = \"none\";\r\n            var keys = Object.keys(alldata);\r\n            keys.reverse();\r\n            keys.forEach(index => {\r\n              if (alldata[index].bin == \"0\") {\r\n                var temp = new Array(4);\r\n                temp[0] = alldata[index].from;\r\n                temp[1] = alldata[index].subject;\r\n                temp[2] = alldata[index].message;\r\n                temp[3] = index;\r\n                this.params.data.push(temp);\r\n              }\r\n            });\r\n          }\r\n          this.printPresentTime();\r\n        },\r\n        errEmailsData => {\r\n          console.log(errEmailsData);\r\n        }\r\n      );\r\n    },\r\n    printPresentTime() {\r\n      var today = new Date();\r\n      this.updateTime =\r\n        today.getHours() + \":\" + today.getMinutes() + \":\" + today.getSeconds();\r\n    },\r\n    onSelectionChange() {\r\n      if (this.$refs.table.getCheckedRowDatas(true).length > 1) {\r\n        this.selectMsgFlag = true;\r\n      } else {\r\n        this.selectMsgFlag = false;\r\n      }\r\n    },\r\n    deleteMsg() {\r\n      var emailObj = new Object();\r\n      for (\r\n        var i = 1;\r\n        i < this.$refs.table.getCheckedRowDatas(true).length;\r\n        i++\r\n      ) {\r\n        var x = this.$refs.table.getCheckedRowDatas(true)[i][3] + \"/bin\";\r\n        emailObj[x] = \"1\";\r\n      }\r\n      while (this.params.data.length > 1) {\r\n        this.params.data.pop();\r\n      }\r\n      var ref = \"emails/\" + this.username + \"/received/\";\r\n      var userRef = firebase.database().ref(ref);\r\n      userRef.update(emailObj).then(() => {\r\n        this.printPresentTime();\r\n        this.selectMsgFlag = false;\r\n      });\r\n    }\r\n  },\r\n  created() {\r\n    this.email = firebase.auth().currentUser.email;\r\n    this.username = this.email.substring(0, this.email.length - 10);\r\n    this.getDataFromFirebase();\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n</style>"]}]}